<!DOCTYPE html><html><head><title>update_form.coffee</title><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><link rel="stylesheet" media="all" href="../../docco.css"></head><body><div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="../../index.html" class="source"><span class="file_name">README</span></a><a href="../../core~/api_mock.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">api_mock.coffee</span></a><a href="../../core~/application_controller.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">application_controller.coffee</span></a><a href="../../core~/auth.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">auth.coffee</span></a><a href="../../core~/base_collection.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">base_collection.coffee</span></a><a href="../../core~/base_model.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">base_model.coffee</span></a><a href="../../core~/base_widgets/autocomplete.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">autocomplete.coffee</span></a><a href="../../core~/base_widgets/base_form.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">base_form.coffee</span></a><a href="../../core~/base_widgets/delete_form.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">delete_form.coffee</span></a><a href="../../core~/base_widgets/expanding_list.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">expanding_list.coffee</span></a><a href="../../core~/base_widgets/item_count.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">item_count.coffee</span></a><a href="../../core~/base_widgets/list.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">list.coffee</span></a><a href="../../core~/base_widgets/mediator_widget.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">mediator_widget.coffee</span></a><a href="../../core~/base_widgets/nested_attributes_form.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">nested_attributes_form.coffee</span></a><a href="../../core~/base_widgets/new_items_count.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">new_items_count.coffee</span></a><a href="../../core~/base_widgets/notification_bar.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">notification_bar.coffee</span></a><a href="../../core~/base_widgets/notifications.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">notifications.coffee</span></a><a href="../../core~/base_widgets/order_by.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">order_by.coffee</span></a><a href="../../core~/base_widgets/update_form.coffee.html" class="source selected"><span class="base_path">core~ / base_widgets / </span><span class="file_name">update_form.coffee</span></a><a href="../../core~/base_widgets/url.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">url.coffee</span></a><a href="../../core~/base_widgets/user_item_count.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">user_item_count.coffee</span></a><a href="../../core~/base_widgets/widget_editor.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">widget_editor.coffee</span></a><a href="../../core~/channels_utils.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">channels_utils.coffee</span></a><a href="../../core~/constants.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">constants.coffee</span></a><a href="../../core~/context_processors.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">context_processors.coffee</span></a><a href="../../core~/controller.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">controller.coffee</span></a><a href="../../core~/core_modules.js.html" class="source "><span class="base_path">core~ / </span><span class="file_name">core_modules.js</span></a><a href="../../core~/datasource/channel/create.coffee.html" class="source "><span class="base_path">core~ / datasource / channel / </span><span class="file_name">create.coffee</span></a><a href="../../core~/datasource/channel/destroy.coffee.html" class="source "><span class="base_path">core~ / datasource / channel / </span><span class="file_name">destroy.coffee</span></a><a href="../../core~/datasource/channel/read.coffee.html" class="source "><span class="base_path">core~ / datasource / channel / </span><span class="file_name">read.coffee</span></a><a href="../../core~/datasource/channel/update.coffee.html" class="source "><span class="base_path">core~ / datasource / channel / </span><span class="file_name">update.coffee</span></a><a href="../../core~/datasource/channel.coffee.html" class="source "><span class="base_path">core~ / datasource / </span><span class="file_name">channel.coffee</span></a><a href="../../core~/datasource/datasource.coffee.html" class="source "><span class="base_path">core~ / datasource / </span><span class="file_name">datasource.coffee</span></a><a href="../../core~/datasource/gc.coffee.html" class="source "><span class="base_path">core~ / datasource / </span><span class="file_name">gc.coffee</span></a><a href="../../core~/datasource/refresher.coffee.html" class="source "><span class="base_path">core~ / datasource / </span><span class="file_name">refresher.coffee</span></a><a href="../../core~/datasource/scheduler.coffee.html" class="source "><span class="base_path">core~ / datasource / </span><span class="file_name">scheduler.coffee</span></a><a href="../../core~/datasource/widget.coffee.html" class="source "><span class="base_path">core~ / datasource / </span><span class="file_name">widget.coffee</span></a><a href="../../core~/flags_collection.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">flags_collection.coffee</span></a><a href="../../core~/interceptor.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">interceptor.coffee</span></a><a href="../../core~/layout.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">layout.coffee</span></a><a href="../../core~/loader.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">loader.coffee</span></a><a href="../../core~/loading_animation.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">loading_animation.coffee</span></a><a href="../../core~/logging/sentry_logger.coffee.html" class="source "><span class="base_path">core~ / logging / </span><span class="file_name">sentry_logger.coffee</span></a><a href="../../core~/logging/standard_logger.coffee.html" class="source "><span class="base_path">core~ / logging / </span><span class="file_name">standard_logger.coffee</span></a><a href="../../core~/mocks.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">mocks.coffee</span></a><a href="../../core~/modal_window.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">modal_window.coffee</span></a><a href="../../core~/module.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">module.coffee</span></a><a href="../../core~/mozaic_backbone_form.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">mozaic_backbone_form.coffee</span></a><a href="../../core~/profiler.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">profiler.coffee</span></a><a href="../../core~/pubsub.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">pubsub.coffee</span></a><a href="../../core~/raw_data.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">raw_data.coffee</span></a><a href="../../core~/router.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">router.coffee</span></a><a href="../../core~/scrollable_widget.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">scrollable_widget.coffee</span></a><a href="../../core~/utils/dom.coffee.html" class="source "><span class="base_path">core~ / utils / </span><span class="file_name">dom.coffee</span></a><a href="../../core~/utils/images.coffee.html" class="source "><span class="base_path">core~ / utils / </span><span class="file_name">images.coffee</span></a><a href="../../core~/utils/misc.coffee.html" class="source "><span class="base_path">core~ / utils / </span><span class="file_name">misc.coffee</span></a><a href="../../core~/utils/mozaic.coffee.html" class="source "><span class="base_path">core~ / utils / </span><span class="file_name">mozaic.coffee</span></a><a href="../../core~/utils/time.coffee.html" class="source "><span class="base_path">core~ / utils / </span><span class="file_name">time.coffee</span></a><a href="../../core~/utils/urls.coffee.html" class="source "><span class="base_path">core~ / utils / </span><span class="file_name">urls.coffee</span></a><a href="../../core~/utils.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">utils.coffee</span></a><a href="../../core~/widget/aggregated_channels.coffee.html" class="source "><span class="base_path">core~ / widget / </span><span class="file_name">aggregated_channels.coffee</span></a><a href="../../core~/widget/backbone_events.coffee.html" class="source "><span class="base_path">core~ / widget / </span><span class="file_name">backbone_events.coffee</span></a><a href="../../core~/widget/channels.coffee.html" class="source "><span class="base_path">core~ / widget / </span><span class="file_name">channels.coffee</span></a><a href="../../core~/widget/modal_widget.coffee.html" class="source "><span class="base_path">core~ / widget / </span><span class="file_name">modal_widget.coffee</span></a><a href="../../core~/widget/params.coffee.html" class="source "><span class="base_path">core~ / widget / </span><span class="file_name">params.coffee</span></a><a href="../../core~/widget/rendering.coffee.html" class="source "><span class="base_path">core~ / widget / </span><span class="file_name">rendering.coffee</span></a><a href="../../core~/widget/states.coffee.html" class="source "><span class="base_path">core~ / widget / </span><span class="file_name">states.coffee</span></a><a href="../../core~/widget/widget.coffee.html" class="source "><span class="base_path">core~ / widget / </span><span class="file_name">widget.coffee</span></a><a href="../../core~/widget_starter.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">widget_starter.coffee</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>update_form.coffee</h1><div class="filepath">core~/base_widgets/</div></th><th class="code"></th></tr></thead><tbody><tr id="section-1"><td class="docs"><div class="pilwrap"><a href="#section-1" class="pilcrow">&#182;</a></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">define</span> <span class="p">[</span><span class="s">&#39;cs!widget/base_form&#39;</span><span class="p">,</span> <span class="s">&#39;cs!channels_utils&#39;</span><span class="p">,</span> <span class="s">&#39;cs!mozaic_backbone_form&#39;</span><span class="p">],</span> <span class="nf">(BaseForm, channels_utils, MozaicBackboneForm) -&gt;</span>

    <span class="k">class</span> <span class="nx">UpdateForm</span> <span class="k">extends</span> <span class="nx">BaseForm</span>

        <span class="nv">template_name: </span><span class="s">&#39;templates/update_form.hjs&#39;</span>
        <span class="nv">render_stringified: </span><span class="kc">true</span></pre></div></td></tr><tr id="section-2"><td class="docs"><div class="pilwrap"><a href="#section-2" class="pilcrow">&#182;</a></div><p>Submit button label for new/edit states, they can be overriden in
subclasses and optionally used in the template at will</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">create_label: </span><span class="s">&#39;Create&#39;</span>
        <span class="nv">update_label: </span><span class="s">&#39;Update&#39;</span>

        <span class="nv">get_subscribed_channel_events: </span><span class="nf">(params) =&gt;</span></pre></div></td></tr><tr id="section-3"><td class="docs"><div class="pilwrap"><a href="#section-3" class="pilcrow">&#182;</a></div><p>Handle any incoming notification on the model's channel.
We subscribe only to item events for ERROR, SYNC, DESTROY
and CHANGE.
Receive the model that's being edited and set it to the
model instance variable. Create the form object and
render the form</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">if</span> <span class="nx">params</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="s">&#39;change&#39;</span>
                <span class="k">if</span> <span class="o">not</span> <span class="nx">@model</span><span class="o">?</span>
                    <span class="k">unless</span> <span class="nx">@requiresAggregateData</span><span class="p">()</span>
                        <span class="vi">@model = </span><span class="nx">params</span><span class="p">.</span><span class="nx">model</span>
                        <span class="nx">@createForm</span><span class="p">()</span>
                        <span class="nx">@render</span><span class="p">(</span><span class="nx">@render_stringified</span><span class="p">)</span>
                <span class="k">else</span>
                    <span class="k">if</span> <span class="nx">params</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span> <span class="o">is</span> <span class="nx">@model</span><span class="p">.</span><span class="nx">id</span></pre></div></td></tr><tr id="section-4"><td class="docs"><div class="pilwrap"><a href="#section-4" class="pilcrow">&#182;</a></div><p>If the model is instantiated and a change has been
been provoked on the model the widget should be closed
as the edit was successfull.
IMPROV: after save is used all over the place ...</p>
</td><td class="code"><div class="highlight"><pre>                        <span class="nx">@afterCommit</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">model</span><span class="p">)</span>
                        <span class="nx">@destroyForm</span><span class="p">()</span></pre></div></td></tr><tr id="section-5"><td class="docs"><div class="pilwrap"><a href="#section-5" class="pilcrow">&#182;</a></div><p>If the event is for an error then update the layout and display
the server errors</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">if</span> <span class="nx">params</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="s">&#39;error&#39;</span></pre></div></td></tr><tr id="section-6"><td class="docs"><div class="pilwrap"><a href="#section-6" class="pilcrow">&#182;</a></div><p>Parse errors from the jqXHR response received as the error
object and add them to the form errors. Enable the form
afterwards to let the user update the model's fields</p>
</td><td class="code"><div class="highlight"><pre>                <span class="nx">@parseServerErrors</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">response</span><span class="p">)</span></pre></div></td></tr><tr id="section-7"><td class="docs"><div class="pilwrap"><a href="#section-7" class="pilcrow">&#182;</a></div><p>If the event is ADD and the model has an id attribute then the model
has been saved successfully and we can destroy this widget</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">if</span> <span class="nx">params</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="s">&#39;add&#39;</span></pre></div></td></tr><tr id="section-8"><td class="docs"><div class="pilwrap"><a href="#section-8" class="pilcrow">&#182;</a></div><p>TODO (bogdan):
Update this method to include a check to see if the model received
via params.model is the same with @model. If this is the case
then we should close the modal. Otherwise we shouldn't :)
1. if not params.model.isNew()
This check should do after update of tag endpoint</p>
</td><td class="code"><div class="highlight"><pre>                <span class="nx">@afterCommit</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">model</span><span class="p">)</span>
                <span class="nx">@destroyForm</span><span class="p">()</span>

        <span class="nv">get_aggregated_channel_events: </span><span class="nf">(params...) =&gt;</span></pre></div></td></tr><tr id="section-9"><td class="docs"><div class="pilwrap"><a href="#section-9" class="pilcrow">&#182;</a></div><p>Mark this as true to prevent re-rendering the form for future calls,
because we have received the initial data for rendering the form.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">return</span> <span class="k">if</span> <span class="nx">@aggregated_channel_events_call_succeeded</span>

            <span class="k">return</span> <span class="kc">false</span> <span class="k">unless</span> <span class="k">super</span><span class="p">(</span><span class="nx">params</span><span class="p">...)</span></pre></div></td></tr><tr id="section-10"><td class="docs"><div class="pilwrap"><a href="#section-10" class="pilcrow">&#182;</a></div><p>FIX IN FUTURE: this is a wanted limitation for now, to prevent
further bugs. After base<em>form::get</em>aggregated<em>channel</em>events was
successfully called, don't allow form re-rendering because
the user could have already modified the form content, and
re-rendering it would mean deleting all the introduced data,
not necessarily existent in the model (the introduced user data is
saved into the form model only when the user pushes commit).</p>

<p>E.g. The user adds text to post a new social post, but while doing so,
a required channel modifies, and causes the form re-rendering. So,
all user's text will be lost. To make this work, we need to somehow
render only a part of the form, not all of it. For now, just ignore
this kind of events.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="vi">@aggregated_channel_events_call_succeeded = </span><span class="kc">true</span></pre></div></td></tr><tr id="section-11"><td class="docs"><div class="pilwrap"><a href="#section-11" class="pilcrow">&#182;</a></div><p>Create form only if you have a view where
to attach it to. If @view has been distroyed, don't.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">if</span> <span class="nx">@view</span>
                <span class="nx">@createForm</span><span class="p">()</span>
                <span class="nx">@render</span><span class="p">(</span><span class="nx">@render_stringified</span><span class="p">)</span></pre></div></td></tr><tr id="section-12"><td class="docs"><div class="pilwrap"><a href="#section-12" class="pilcrow">&#182;</a></div><p>Implement superclass interface of return true when data has been
received and accepted</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">return</span> <span class="kc">true</span>

        <span class="nv">action: </span><span class="o">=&gt;</span>
            <span class="k">super</span><span class="p">()</span></pre></div></td></tr><tr id="section-13"><td class="docs"><div class="pilwrap"><a href="#section-13" class="pilcrow">&#182;</a></div><p>Validate the form client side</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nv">errors = </span><span class="nx">@form</span><span class="p">.</span><span class="nx">commit</span><span class="p">()</span></pre></div></td></tr><tr id="section-14"><td class="docs"><div class="pilwrap"><a href="#section-14" class="pilcrow">&#182;</a></div><p>After commiting the form values to the form model
(now the form's model will have the form's values
set as attributes) execute an afterFormCommit callback to
allow us to add any additional attributes on the model</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nx">@afterFormCommit</span><span class="p">(</span><span class="nx">@form</span><span class="p">.</span><span class="nx">model</span><span class="p">)</span>
            <span class="k">if</span> <span class="o">not</span> <span class="nx">errors</span><span class="o">?</span></pre></div></td></tr><tr id="section-15"><td class="docs"><div class="pilwrap"><a href="#section-15" class="pilcrow">&#182;</a></div><p>Update the model with the form's model attributes
but don't trigger any events</p>
</td><td class="code"><div class="highlight"><pre>                <span class="nx">@model</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">@getFormModelAttributes</span><span class="p">(),</span> <span class="p">{</span> <span class="nv">silent: </span><span class="kc">true</span> <span class="p">})</span></pre></div></td></tr><tr id="section-16"><td class="docs"><div class="pilwrap"><a href="#section-16" class="pilcrow">&#182;</a></div><p>Try to create/update the model on the server</p>
</td><td class="code"><div class="highlight"><pre>                <span class="nx">@syncModel</span><span class="p">(</span><span class="s">&#39;update&#39;</span><span class="p">)</span>
            <span class="k">else</span></pre></div></td></tr><tr id="section-17"><td class="docs"><div class="pilwrap"><a href="#section-17" class="pilcrow">&#182;</a></div><p>Let the user correct the validation errors by
enabling the form</p>
</td><td class="code"><div class="highlight"><pre>                <span class="nx">@enableForm</span><span class="p">()</span>

        <span class="nv">getFormModelAttributes: </span><span class="nf">-&gt;</span>
            <span class="k">return</span> <span class="nx">@form</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">attributes</span>

        <span class="nv">getFormSchemaName: </span><span class="nf">-&gt;</span></pre></div></td></tr><tr id="section-18"><td class="docs"><div class="pilwrap"><a href="#section-18" class="pilcrow">&#182;</a></div><p>Get the schema of this form. It can either be 'default' or
a value coming in from params.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">if</span> <span class="nx">@model_schema</span><span class="o">?</span> <span class="k">then</span> <span class="nx">@model_schema</span> <span class="k">else</span> <span class="s">&#39;default&#39;</span>

        <span class="nv">createForm: </span><span class="o">=&gt;</span></pre></div></td></tr><tr id="section-19"><td class="docs"><div class="pilwrap"><a href="#section-19" class="pilcrow">&#182;</a></div><p>Create a Backbone form based on the associated widget's model
and set it on the instance variable form.</p>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-20"><td class="docs"><div class="pilwrap"><a href="#section-20" class="pilcrow">&#182;</a></div><p>when no model is attached</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">return</span> <span class="k">unless</span> <span class="nx">@model</span>

            <span class="nv">clone = </span><span class="nx">@model</span><span class="p">.</span><span class="nx">clone</span><span class="p">()</span></pre></div></td></tr><tr id="section-21"><td class="docs"><div class="pilwrap"><a href="#section-21" class="pilcrow">&#182;</a></div><p>Send the schema as an argument using model.getSchema as schema
callbacks for fields (like options for the Users select in Task
model) depend on model attributes which are not present when
the model is created. Execute those callbacks when there's
data on the model to render the fields. The holder argument is
a reference to the widget's view required to render custom
template fields (instead of letting BBF do it's magic)</p>
</td><td class="code"><div class="highlight"><pre>            <span class="vi">@form = </span><span class="k">new</span> <span class="nx">MozaicBackboneForm</span> <span class="p">({</span> <span class="nv">model: </span><span class="nx">clone</span><span class="p">,</span> <span class="nv">schema: </span><span class="nx">clone</span><span class="p">.</span><span class="nx">getSchema</span><span class="p">(</span><span class="nx">@getFormSchemaName</span><span class="p">()),</span> <span class="nv">holder: </span><span class="nx">@view</span><span class="p">.</span><span class="nx">el</span> <span class="p">})</span></pre></div></td></tr><tr id="section-22"><td class="docs"><div class="pilwrap"><a href="#section-22" class="pilcrow">&#182;</a></div><p>Make this form available inside editors and anywhere else where
the Backbone form would pass its reference, by attaching a
reference to this form widget on the Backbone form itself</p>
</td><td class="code"><div class="highlight"><pre>            <span class="vi">@form.formWidget = </span><span class="k">this</span>

        <span class="nv">renderForm: </span><span class="o">=&gt;</span></pre></div></td></tr><tr id="section-23"><td class="docs"><div class="pilwrap"><a href="#section-23" class="pilcrow">&#182;</a></div><p>Renders a Backbone Form bound to this widget's model
and append the form's element to the widget's DOM</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nx">@beforeRender</span><span class="p">(</span><span class="nx">@form</span><span class="p">.</span><span class="nx">model</span><span class="p">)</span>
            <span class="nx">@form</span><span class="p">.</span><span class="nx">render</span><span class="p">()</span>
            <span class="nx">@afterRender</span><span class="p">(</span><span class="nx">@form</span><span class="p">.</span><span class="nx">model</span><span class="p">)</span>
            <span class="nx">$</span><span class="p">(</span><span class="nx">@view</span><span class="p">.</span><span class="nx">el</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="s">&quot;.form&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">@form</span><span class="p">.</span><span class="nx">el</span><span class="p">)</span>

        <span class="nv">renderLayout: </span><span class="nf">(params) -&gt;</span></pre></div></td></tr><tr id="section-24"><td class="docs"><div class="pilwrap"><a href="#section-24" class="pilcrow">&#182;</a></div><p>{{button_label}} needs to be used as the submit button's value
in the template for the labels to come into effect</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nv">params.button_label = </span><span class="k">if</span> <span class="nx">@model</span><span class="p">.</span><span class="nx">id</span> <span class="k">then</span> <span class="nx">@update_label</span> <span class="k">else</span> <span class="nx">@create_label</span>
            <span class="k">super</span><span class="p">(</span><span class="nx">arguments</span><span class="p">...)</span>

        <span class="nv">beforeRender: </span><span class="o">=&gt;</span></pre></div></td></tr><tr id="section-25"><td class="docs"><div class="pilwrap"><a href="#section-25" class="pilcrow">&#182;</a></div><p>allows modification of underlying model before rendering</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">afterRender: </span><span class="o">=&gt;</span></pre></div></td></tr><tr id="section-26"><td class="docs"><div class="pilwrap"><a href="#section-26" class="pilcrow">&#182;</a></div><p>allows modification of the form or underlying model right after rendering
ex: use to mark as selected an <option> in a <selected> form field</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">afterFormCommit: </span><span class="nf">(model) =&gt;</span>

        <span class="nv">destroy: </span><span class="o">=&gt;</span>
            <span class="k">super</span><span class="p">()</span></pre></div></td></tr><tr id="section-27"><td class="docs"><div class="pilwrap"><a href="#section-27" class="pilcrow">&#182;</a></div><p>Remove cross-reference between Backbone form and form widget</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">delete</span> <span class="nx">@form</span><span class="p">.</span><span class="nx">formWidget</span> <span class="k">if</span> <span class="nx">@form</span>

    <span class="k">return</span> <span class="nx">UpdateForm</span>

</pre></div></td></tr></tbody></table><div id="generated">generated Mon Aug 05 2013 15:56:33 GMT+0300 (EEST)  </div></div></body></html>