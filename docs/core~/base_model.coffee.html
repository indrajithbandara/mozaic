<!DOCTYPE html><html><head><title>base_model.coffee</title><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><link rel="stylesheet" media="all" href="../docco.css"></head><body><div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="../index.html" class="source"><span class="file_name">README</span></a><a href="../core~/api_mock.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">api_mock.coffee</span></a><a href="../core~/application_controller.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">application_controller.coffee</span></a><a href="../core~/auth.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">auth.coffee</span></a><a href="../core~/base_collection.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">base_collection.coffee</span></a><a href="../core~/base_model.coffee.html" class="source selected"><span class="base_path">core~ / </span><span class="file_name">base_model.coffee</span></a><a href="../core~/base_widgets/autocomplete.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">autocomplete.coffee</span></a><a href="../core~/base_widgets/base_form.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">base_form.coffee</span></a><a href="../core~/base_widgets/delete_form.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">delete_form.coffee</span></a><a href="../core~/base_widgets/expanding_list.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">expanding_list.coffee</span></a><a href="../core~/base_widgets/item_count.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">item_count.coffee</span></a><a href="../core~/base_widgets/list.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">list.coffee</span></a><a href="../core~/base_widgets/mediator_widget.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">mediator_widget.coffee</span></a><a href="../core~/base_widgets/nested_attributes_form.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">nested_attributes_form.coffee</span></a><a href="../core~/base_widgets/new_items_count.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">new_items_count.coffee</span></a><a href="../core~/base_widgets/notification_bar.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">notification_bar.coffee</span></a><a href="../core~/base_widgets/notifications.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">notifications.coffee</span></a><a href="../core~/base_widgets/order_by.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">order_by.coffee</span></a><a href="../core~/base_widgets/update_form.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">update_form.coffee</span></a><a href="../core~/base_widgets/url.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">url.coffee</span></a><a href="../core~/base_widgets/user_item_count.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">user_item_count.coffee</span></a><a href="../core~/base_widgets/widget_editor.coffee.html" class="source "><span class="base_path">core~ / base_widgets / </span><span class="file_name">widget_editor.coffee</span></a><a href="../core~/channels_utils.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">channels_utils.coffee</span></a><a href="../core~/constants.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">constants.coffee</span></a><a href="../core~/context_processors.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">context_processors.coffee</span></a><a href="../core~/controller.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">controller.coffee</span></a><a href="../core~/core_modules.js.html" class="source "><span class="base_path">core~ / </span><span class="file_name">core_modules.js</span></a><a href="../core~/datasource/channel/create.coffee.html" class="source "><span class="base_path">core~ / datasource / channel / </span><span class="file_name">create.coffee</span></a><a href="../core~/datasource/channel/destroy.coffee.html" class="source "><span class="base_path">core~ / datasource / channel / </span><span class="file_name">destroy.coffee</span></a><a href="../core~/datasource/channel/read.coffee.html" class="source "><span class="base_path">core~ / datasource / channel / </span><span class="file_name">read.coffee</span></a><a href="../core~/datasource/channel/update.coffee.html" class="source "><span class="base_path">core~ / datasource / channel / </span><span class="file_name">update.coffee</span></a><a href="../core~/datasource/channel.coffee.html" class="source "><span class="base_path">core~ / datasource / </span><span class="file_name">channel.coffee</span></a><a href="../core~/datasource/datasource.coffee.html" class="source "><span class="base_path">core~ / datasource / </span><span class="file_name">datasource.coffee</span></a><a href="../core~/datasource/gc.coffee.html" class="source "><span class="base_path">core~ / datasource / </span><span class="file_name">gc.coffee</span></a><a href="../core~/datasource/refresher.coffee.html" class="source "><span class="base_path">core~ / datasource / </span><span class="file_name">refresher.coffee</span></a><a href="../core~/datasource/scheduler.coffee.html" class="source "><span class="base_path">core~ / datasource / </span><span class="file_name">scheduler.coffee</span></a><a href="../core~/datasource/widget.coffee.html" class="source "><span class="base_path">core~ / datasource / </span><span class="file_name">widget.coffee</span></a><a href="../core~/flags_collection.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">flags_collection.coffee</span></a><a href="../core~/interceptor.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">interceptor.coffee</span></a><a href="../core~/layout.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">layout.coffee</span></a><a href="../core~/loader.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">loader.coffee</span></a><a href="../core~/loading_animation.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">loading_animation.coffee</span></a><a href="../core~/logging/sentry_logger.coffee.html" class="source "><span class="base_path">core~ / logging / </span><span class="file_name">sentry_logger.coffee</span></a><a href="../core~/logging/standard_logger.coffee.html" class="source "><span class="base_path">core~ / logging / </span><span class="file_name">standard_logger.coffee</span></a><a href="../core~/mocks.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">mocks.coffee</span></a><a href="../core~/modal_window.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">modal_window.coffee</span></a><a href="../core~/module.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">module.coffee</span></a><a href="../core~/mozaic_backbone_form.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">mozaic_backbone_form.coffee</span></a><a href="../core~/profiler.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">profiler.coffee</span></a><a href="../core~/pubsub.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">pubsub.coffee</span></a><a href="../core~/raw_data.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">raw_data.coffee</span></a><a href="../core~/router.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">router.coffee</span></a><a href="../core~/scrollable_widget.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">scrollable_widget.coffee</span></a><a href="../core~/utils/dom.coffee.html" class="source "><span class="base_path">core~ / utils / </span><span class="file_name">dom.coffee</span></a><a href="../core~/utils/images.coffee.html" class="source "><span class="base_path">core~ / utils / </span><span class="file_name">images.coffee</span></a><a href="../core~/utils/misc.coffee.html" class="source "><span class="base_path">core~ / utils / </span><span class="file_name">misc.coffee</span></a><a href="../core~/utils/mozaic.coffee.html" class="source "><span class="base_path">core~ / utils / </span><span class="file_name">mozaic.coffee</span></a><a href="../core~/utils/time.coffee.html" class="source "><span class="base_path">core~ / utils / </span><span class="file_name">time.coffee</span></a><a href="../core~/utils/urls.coffee.html" class="source "><span class="base_path">core~ / utils / </span><span class="file_name">urls.coffee</span></a><a href="../core~/utils.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">utils.coffee</span></a><a href="../core~/widget/aggregated_channels.coffee.html" class="source "><span class="base_path">core~ / widget / </span><span class="file_name">aggregated_channels.coffee</span></a><a href="../core~/widget/backbone_events.coffee.html" class="source "><span class="base_path">core~ / widget / </span><span class="file_name">backbone_events.coffee</span></a><a href="../core~/widget/channels.coffee.html" class="source "><span class="base_path">core~ / widget / </span><span class="file_name">channels.coffee</span></a><a href="../core~/widget/modal_widget.coffee.html" class="source "><span class="base_path">core~ / widget / </span><span class="file_name">modal_widget.coffee</span></a><a href="../core~/widget/params.coffee.html" class="source "><span class="base_path">core~ / widget / </span><span class="file_name">params.coffee</span></a><a href="../core~/widget/rendering.coffee.html" class="source "><span class="base_path">core~ / widget / </span><span class="file_name">rendering.coffee</span></a><a href="../core~/widget/states.coffee.html" class="source "><span class="base_path">core~ / widget / </span><span class="file_name">states.coffee</span></a><a href="../core~/widget/widget.coffee.html" class="source "><span class="base_path">core~ / widget / </span><span class="file_name">widget.coffee</span></a><a href="../core~/widget_starter.coffee.html" class="source "><span class="base_path">core~ / </span><span class="file_name">widget_starter.coffee</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>base_model.coffee</h1><div class="filepath">core~/</div></th><th class="code"></th></tr></thead><tbody><tr id="section-1"><td class="docs"><div class="pilwrap"><a href="#section-1" class="pilcrow">&#182;</a></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">define</span> <span class="p">[],</span> <span class="p">()</span> <span class="nf">-&gt;</span>
    <span class="k">class</span> <span class="nx">BaseModel</span> <span class="k">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Model</span>

        <span class="nv">unsyncable_attributes: </span><span class="p">[]</span></pre></div></td></tr><tr id="section-2"><td class="docs"><div class="pilwrap"><a href="#section-2" class="pilcrow">&#182;</a></div><p>This array is looked up in datasource and the values
from sync<em>with</em>server are searched in the response
and overwritten in the model, if they exist.</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">sync_with_server: </span><span class="p">[]</span>

        <span class="nv">initialize: </span><span class="nf">-&gt;</span></pre></div></td></tr><tr id="section-3"><td class="docs"><div class="pilwrap"><a href="#section-3" class="pilcrow">&#182;</a></div><p>Add global unsyncable attributes on top of model specific ones
TODO: This is commented out for now because the stream wizard
depends on it. We should find a way to wire this property through
our local channels without sending it to the server
@unsyncable_attributes.push('form')</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nv">validate: </span><span class="nf">(attributes, options) -&gt;</span></pre></div></td></tr><tr id="section-4"><td class="docs"><div class="pilwrap"><a href="#section-4" class="pilcrow">&#182;</a></div><p>Check to see if the model is already in collection and
log this as a warning message</p>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-5"><td class="docs"><div class="pilwrap"><a href="#section-5" class="pilcrow">&#182;</a></div><p>Don't prevent adding an existing item to a collection
(because it will throw an error). However, log a message
for the developers to know there's something wrong.</p>

<p>When this message is logged, it means that we're probably
requesting the same data more than once and wasting HTTP requests.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">if</span> <span class="nx">options</span> <span class="o">and</span> <span class="nx">options</span><span class="p">.</span><span class="nx">collection</span> <span class="o">and</span> <span class="nx">options</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span>
                <span class="nx">logger</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s">&quot;Trying to add an existing model </span><span class="si">#{</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="s"> &quot;</span> <span class="o">+</span>
                         <span class="s">&quot;(</span><span class="si">#{</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">attributes</span><span class="p">)</span><span class="si">}</span><span class="s">}) to a collection&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="kc">false</span>

        <span class="nv">set: </span><span class="nf">(key, value, options) -&gt;</span></pre></div></td></tr><tr id="section-6"><td class="docs"><div class="pilwrap"><a href="#section-6" class="pilcrow">&#182;</a></div><p>The global Backbone Model setter is extended in order to
provide an internal system for custom individual setter
listeners. Contrary to listening to the change event, these
handlers are called even when an attribute is silently set.
Backbone Model supports both single and mass-assignments, the
call can be key-value based, for one attribute only, or receive
an object, whose keys and values are set individually</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nv">attrs = </span><span class="p">{}</span>
            <span class="k">if</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span>
                <span class="nx">attrs</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span>
            <span class="k">else</span> <span class="k">if</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span>
                <span class="nv">attrs = </span><span class="nx">key</span>

            <span class="k">unless</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">(</span><span class="nx">attrs</span><span class="p">)</span>
                <span class="k">for</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">v</span> <span class="k">of</span> <span class="nx">attrs</span>
                    <span class="nv">method = </span><span class="s">&quot;set_</span><span class="si">#{</span><span class="nx">k</span><span class="si">}</span><span class="s">&quot;</span>
                    <span class="k">if</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">method</span><span class="p">])</span></pre></div></td></tr><tr id="section-7"><td class="docs"><div class="pilwrap"><a href="#section-7" class="pilcrow">&#182;</a></div><p>Send all attributes and options to each listener
along with the value because they might make a
difference to some</p>
</td><td class="code"><div class="highlight"><pre>                        <span class="k">this</span><span class="p">[</span><span class="nx">method</span><span class="p">](</span><span class="nx">v</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span></pre></div></td></tr><tr id="section-8"><td class="docs"><div class="pilwrap"><a href="#section-8" class="pilcrow">&#182;</a></div><p>Do the actual assignment after the custom listeners, in order
to be able to compare new values with old ones</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">super</span><span class="p">(</span><span class="nx">arguments</span><span class="p">...)</span></pre></div></td></tr><tr id="section-9"><td class="docs"><div class="pilwrap"><a href="#section-9" class="pilcrow">&#182;</a></div><p>The current object needs to be returned after set according to
the Backbone Model interface</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">return</span> <span class="k">this</span>

        <span class="nv">url: </span><span class="nf">-&gt;</span></pre></div></td></tr><tr id="section-10"><td class="docs"><div class="pilwrap"><a href="#section-10" class="pilcrow">&#182;</a></div><p>Returns the url of the model or the url of the collection
if the model has not been saved yet.
http://documentcloud.github.com/backbone/#Model-url
A model that has not yet been saved will not have a collection
(this is our usage pattern right now). Fallback to the
urlRoot of the model in that case</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">if</span> <span class="nx">@collection</span><span class="o">?</span>
                <span class="k">if</span> <span class="nx">@id</span><span class="o">?</span>
                    <span class="k">return</span> <span class="nx">Utils</span><span class="p">.</span><span class="nx">model_url</span><span class="p">(</span><span class="nx">@collection</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span> <span class="nx">@id</span><span class="p">)</span>
                <span class="k">else</span>
                    <span class="k">return</span> <span class="nx">@collection</span><span class="p">.</span><span class="nx">url</span>
            <span class="k">else</span> <span class="k">if</span> <span class="nx">@urlRoot</span><span class="o">?</span>
                <span class="k">if</span> <span class="nx">@id</span><span class="o">?</span>
                    <span class="k">return</span> <span class="nx">Utils</span><span class="p">.</span><span class="nx">model_url</span><span class="p">(</span><span class="nx">@urlRoot</span><span class="p">,</span> <span class="nx">@id</span><span class="p">)</span>
                <span class="k">else</span>
                    <span class="k">return</span> <span class="nx">@urlRoot</span>
            <span class="k">throw</span><span class="p">(</span><span class="s">&#39;Set a collection or the urlRoot property on the model&#39;</span><span class="p">)</span>

        <span class="nv">getNested: </span><span class="nf">(path) -&gt;</span></pre></div></td></tr><tr id="section-11"><td class="docs"><div class="pilwrap"><a href="#section-11" class="pilcrow">&#182;</a></div><p>@path {String}  Object path e.g. 'user/name'
@return {Mixed}</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">return</span> <span class="nx">Utils</span><span class="p">.</span><span class="nx">getNestedAttr</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">path</span><span class="p">)</span>

        <span class="nv">getSchema: </span><span class="nf">(schema_name = &#39;default&#39;) -&gt;</span>
            <span class="k">throw</span><span class="p">(</span><span class="s">&#39;Implement this in your model for form support&#39;</span><span class="p">)</span>

        <span class="nv">postCreate: </span><span class="nf">(model) =&gt;</span></pre></div></td></tr><tr id="section-12"><td class="docs"><div class="pilwrap"><a href="#section-12" class="pilcrow">&#182;</a></div><p>Overwrite this in your model in order to ALWAYS run
code exactly after the model has been successfully saved
to the server.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">return</span>

        <span class="nv">postUpdate: </span><span class="nf">(model) =&gt;</span></pre></div></td></tr><tr id="section-13"><td class="docs"><div class="pilwrap"><a href="#section-13" class="pilcrow">&#182;</a></div><p>Overwrite this in your model in order to ALWAYS run
code exactly after the model has been successfully updated
on the server.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">return</span>

        <span class="nv">postDelete: </span><span class="nf">(model) =&gt;</span></pre></div></td></tr><tr id="section-14"><td class="docs"><div class="pilwrap"><a href="#section-14" class="pilcrow">&#182;</a></div><p>Overwrite this in your model in order to ALWAYS run
code exactly after the model has been successfully deleted
from the server.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">return</span>

        <span class="nv">postCUD: </span><span class="nf">(model) =&gt;</span></pre></div></td></tr><tr id="section-15"><td class="docs"><div class="pilwrap"><a href="#section-15" class="pilcrow">&#182;</a></div><p>Overwrite this in your model in order to ALWAYS run
code exactly after the model has been either created, or
updated, or deleted.</p>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-16"><td class="docs"><div class="pilwrap"><a href="#section-16" class="pilcrow">&#182;</a></div><p>If you're concerned with the type of update, you should
overwrite the more specific methods (postCreate, postUpdate,
postDelete).</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">return</span>

        <span class="nv">save: </span><span class="nf">(key, value, options) -&gt;</span></pre></div></td></tr><tr id="section-17"><td class="docs"><div class="pilwrap"><a href="#section-17" class="pilcrow">&#182;</a></div><p>Overwrite the save method to provide a way to
black list unwanted local attributes.
For example we set a folders attribute on a stream
and that doesn't map to any server attributes, so
we shouldn't send it.</p>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-18"><td class="docs"><div class="pilwrap"><a href="#section-18" class="pilcrow">&#182;</a></div><p>Iterate over the unsyncable attributes and unset their
values before sending the request to the server and
then set them back once the operation is done.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nv">unsynced_values = </span><span class="p">[]</span>
            <span class="k">for</span> <span class="nx">attribute</span> <span class="k">in</span> <span class="nx">@unsyncable_attributes</span></pre></div></td></tr><tr id="section-19"><td class="docs"><div class="pilwrap"><a href="#section-19" class="pilcrow">&#182;</a></div><p>Keep the current value of the attribute
to set it again after the save</p>
</td><td class="code"><div class="highlight"><pre>                <span class="nx">unsynced_values</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">@get</span><span class="p">(</span><span class="nx">attribute</span><span class="p">))</span>
                <span class="nx">@unset</span><span class="p">(</span><span class="nx">attribute</span><span class="p">,</span> <span class="p">{</span> <span class="nv">silent: </span><span class="kc">true</span> <span class="p">})</span></pre></div></td></tr><tr id="section-20"><td class="docs"><div class="pilwrap"><a href="#section-20" class="pilcrow">&#182;</a></div><p>Options might not be passed from above
Model#save() can be called in three ways:
1. model.save() or
2. model.save(key, value, options)
3. model.save({key: value,...}, options)
@see http://backbonejs.org/docs/backbone.html
In the third case, <code>value</code> param is in fact the options hash,
so to overwrite save() we need to check for this case.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">if</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="c1"># second call type</span>
                <span class="nv">old_success = </span><span class="nx">options</span><span class="p">.</span><span class="nx">success</span> <span class="o">or</span> <span class="nx">$</span><span class="p">.</span><span class="nx">noop</span>
            <span class="k">if</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="c1"># third call type</span>
                <span class="nv">old_success = </span><span class="nx">value</span><span class="p">.</span><span class="nx">success</span> <span class="o">or</span> <span class="nx">$</span><span class="p">.</span><span class="nx">noop</span>

            <span class="nv">new_success = </span><span class="nf">(model, response) =&gt;</span>
                <span class="p">(</span><span class="k">if</span> <span class="nx">@isNew</span><span class="p">()</span> <span class="k">then</span> <span class="nx">@postCreate</span> <span class="k">else</span> <span class="nx">@postUpdate</span><span class="p">)(</span><span class="nx">model</span><span class="p">)</span>
                <span class="nx">@postCUD</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span>
                <span class="nx">old_success</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">response</span><span class="p">)</span>

            <span class="k">if</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span> <span class="nx">options</span>
                <span class="nv">options.success = </span><span class="nx">new_success</span>
            <span class="k">if</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span> <span class="nx">key</span>
                <span class="nv">value.success = </span><span class="nx">new_success</span>

            <span class="k">super</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span>
            <span class="k">for</span> <span class="nx">attribute</span><span class="p">,</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">@unsyncable_attributes</span></pre></div></td></tr><tr id="section-21"><td class="docs"><div class="pilwrap"><a href="#section-21" class="pilcrow">&#182;</a></div><p>Set the old value back</p>
</td><td class="code"><div class="highlight"><pre>                <span class="nx">@set</span><span class="p">(</span><span class="nx">attribute</span><span class="p">,</span> <span class="nx">unsynced_values</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="p">{</span> <span class="nv">silent: </span><span class="kc">true</span> <span class="p">})</span>

        <span class="nv">destroy: </span><span class="nf">(options) =&gt;</span></pre></div></td></tr><tr id="section-22"><td class="docs"><div class="pilwrap"><a href="#section-22" class="pilcrow">&#182;</a></div><p>Overwrite the destroy method to provide an easy hook
for models to execute code after the model is successfully
deleted.</p>
</td><td class="code"><div class="highlight"><pre>            <span class="nv">options = </span><span class="nx">_</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="o">or</span> <span class="p">{}</span>
            <span class="nv">old_success = </span><span class="nx">options</span><span class="p">.</span><span class="nx">sucess</span> <span class="o">or</span> <span class="o">=&gt;</span>
            <span class="nv">options.success = </span><span class="nf">(model, response) =&gt;</span>
                                  <span class="nx">@postDelete</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span>
                                  <span class="nx">@postCUD</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span>
                                  <span class="nx">old_success</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">response</span><span class="p">)</span>
            <span class="k">super</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span>

    <span class="k">return</span> <span class="nx">BaseModel</span>

</pre></div></td></tr></tbody></table><div id="generated">generated Mon Aug 05 2013 15:56:30 GMT+0300 (EEST)  </div></div></body></html>